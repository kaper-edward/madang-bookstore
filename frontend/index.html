<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë§ˆë‹¹ ì˜¨ë¼ì¸ ì„œì </title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body class="bg-slate-950">
  <div class="min-h-screen bg-gradient-to-br from-slate-900 via-slate-950 to-slate-900 text-slate-100">
    <header class="glass-panel border-b border-white/10">
      <!-- í—¤ë”ëŠ” JavaScriptë¡œ ë™ì  ë Œë”ë§ë©ë‹ˆë‹¤ -->
    </header>

    <main class="max-w-6xl mx-auto px-6 py-12 space-y-12">
      <section class="hero-panel glass-panel">
        <div class="space-y-4">
          <span class="inline-flex items-center gap-2 bg-primary-500/20 text-primary-200 px-3 py-1 rounded-full text-sm font-medium">
            <span class="text-lg">âœ¨</span> CRUD + SQL + JDBC í•™ìŠµìš© í”„ë¡œì íŠ¸
          </span>
          <h1 class="text-4xl md:text-5xl font-bold leading-tight">
            ë§ˆë‹¹ ì˜¨ë¼ì¸ ì„œì ê³¼ í•¨ê»˜ <span class="text-primary-200">í’€ìŠ¤íƒ</span> íë¦„ì„ ì²´í—˜í•˜ì„¸ìš”
          </h1>
          <p class="text-lg text-slate-300 max-w-3xl">
            ê°„ë‹¨í•œ HTTP ì„œë²„ì™€ MySQLì„ í™œìš©í•œ êµìœ¡ìš© í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤. í•™ìƒë“¤ì´ ì§ì ‘ SQLê³¼ REST APIë¥¼ í™•ì¸í•˜ë©´ì„œ CRUD íë¦„ê³¼ UI/UXë¥¼ ëª¨ë‘ ì—°ìŠµí•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.
          </p>
          <div class="flex flex-wrap gap-3">
            <a href="customer-login.html" class="btn-primary">ê³ ê° ì„ íƒí•˜ê¸°</a>
            <a href="books.html" class="btn-outline">ë„ì„œ ë‘˜ëŸ¬ë³´ê¸°</a>
            <a href="my-orders.html" class="btn-outline">ë‚´ ì£¼ë¬¸ ê´€ë¦¬</a>
          </div>
        </div>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-slate-300">
          <div class="info-chip">Java 21 HttpServer</div>
          <div class="info-chip">MySQL + JDBC</div>
          <div class="info-chip">Vanilla JS + Tailwind</div>
          <div class="info-chip">SQL ë¡œê·¸ ì‹œê°í™”</div>
        </div>
      </section>

      <section>
        <div class="flex items-center justify-between mb-4">
          <h2 class="section-title">ìµœì‹  ë„ì„œ</h2>
          <button id="refresh-books" class="btn-ghost text-sm">ìƒˆë¡œê³ ì¹¨</button>
        </div>
        <div id="latest-books-grid" class="grid md:grid-cols-3 gap-6">
          <div class="glass-panel-secondary p-6 text-center text-slate-300">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</div>
        </div>
      </section>

      <section class="glass-panel p-6 space-y-4">
        <div class="flex items-center gap-3">
          <span class="text-2xl">ğŸ› ï¸</span>
          <div>
            <h2 class="text-xl font-semibold">ì„œë²„ ìƒíƒœ ì ê²€</h2>
            <p class="text-sm text-slate-300">ë²„íŠ¼ì„ ëˆŒëŸ¬ REST APIê°€ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”. SQL ë¡œê·¸ë„ í•¨ê»˜ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
          </div>
        </div>
        <div class="bg-black/40 border border-white/10 rounded-xl p-4">
          <pre id="server-status" class="text-sm text-primary-200 whitespace-pre-wrap">ì„œë²„ ì—°ê²° í™•ì¸ ì¤‘...</pre>
        </div>
        <div class="flex gap-3">
          <button id="test-server" class="btn-primary">ì„œë²„ í…ŒìŠ¤íŠ¸</button>
          <a href="../README.md" class="btn-outline" target="_blank">ì‹¤í–‰ ê°€ì´ë“œ ë³´ê¸°</a>
        </div>
      </section>
    </main>

    <footer class="border-t border-white/10 bg-slate-950/80 backdrop-blur-md mt-20">
      <!-- í‘¸í„°ëŠ” JavaScriptë¡œ ë™ì  ë Œë”ë§ë©ë‹ˆë‹¤ -->
    </footer>
  </div>

  <script src="js/api.js"></script>
  <script src="js/header.js"></script>
  <script>
    window.addEventListener('DOMContentLoaded', () => {
      renderHeader('');
      renderFooter();
      loadLatestBooks();
      testServerConnection();

      document.getElementById('test-server').addEventListener('click', testServerConnection);
      document.getElementById('refresh-books').addEventListener('click', loadLatestBooks);
    });

    async function loadLatestBooks() {
      try {
        const response = await fetchAPI('/api/books?action=list&sortBy=bookid&direction=desc');
        const books = response.data || [];
        renderLatestBooks(books.slice(0, 3));
      } catch (error) {
        renderLatestBooks([]);
      }
    }

    function renderLatestBooks(books) {
      const grid = document.getElementById('latest-books-grid');
      if (!grid) return;

      if (!books.length) {
        grid.innerHTML = `<div class="glass-panel-secondary p-6 text-center text-slate-400">ë„ì„œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</div>`;
        return;
      }

      grid.innerHTML = books.map((book) => `
        <article class="glass-panel p-6 space-y-3">
          <p class="text-sm text-slate-400">#${book.bookid}</p>
          <h3 class="text-xl font-semibold">${escapeHtml(book.bookname)}</h3>
          <p class="text-slate-300">${escapeHtml(book.publisher)}</p>
          <p class="text-primary-200 font-semibold">${formatCurrency(book.price)}</p>
          <a href="book-detail.html?id=${book.bookid}" class="btn-outline w-full">ìƒì„¸ ë³´ê¸°</a>
        </article>
      `).join('');
    }

    async function testServerConnection() {
      const status = document.getElementById('server-status');
      if (!status) return;

      try {
        const response = await fetchAPI('/api/test');
        status.textContent = JSON.stringify(response, null, 2);
      } catch (error) {
        status.textContent = `ì„œë²„ ì—°ê²° ì‹¤íŒ¨: ${error.message}`;
      }
    }

    function escapeHtml(value) {
      if (value === null || value === undefined) return '';
      return value
        .toString()
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#39;');
    }
  </script>
</body>
</html>
